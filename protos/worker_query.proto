syntax = "proto3";

option java_package = "org.oliverlittle.clusterprocess";

import "table_model.proto";
import "data_source.proto";

service WorkerComputeService {
    // Computes a partial result
    rpc ComputePartialResultCassandra(ComputePartialResultCassandraRequest) returns (stream StreamedTableResult);
    rpc GetLocalCassandraNode(GetLocalCassandraNodeRequest) returns (GetLocalCassandraNodeResult);
    rpc ProcessQueryPlanItem(ProcessQueryPlanItemRequest) returns (ProcessQueryPlanItemResult);
    rpc GetCachedResult(GetCachedResultRequest) returns (stream StreamedTableResult);
}

message GetLocalCassandraNodeRequest {

}

message GetLocalCassandraNodeResult {
    InetSocketAddress address = 1;
}

message ComputePartialResultCassandraRequest {
    Table table = 1;
    CassandraDataSource dataSource = 2;
    CassandraTokenRange tokenRange = 3;
}

message ProcessQueryPlanItemRequest {

}

message ProcessQueryPlanItemResult {

}

message GetCachedResultRequest {
    Table table = 1;
}